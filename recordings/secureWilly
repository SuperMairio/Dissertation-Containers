{"version": 2, "width": 80, "height": 24, "timestamp": 1621513883, "idle_time_limit": 1.0, "env": {"SHELL": "/bin/bash", "TERM": "xterm-256color"}}
[0.020435, "o", "\u001b]0;ubuntu@ubuntu2004: ~/SecureWilly/Parser\u0007\u001b[01;32mubuntu@ubuntu2004\u001b[00m:\u001b[01;34m~/SecureWilly/Parser\u001b[00m$ "]
[0.632242, "o", "s"]
[0.812099, "o", "u"]
[0.920295, "o", "d"]
[1.028011, "o", "o"]
[1.18406, "o", " "]
[1.796242, "o", "b"]
[1.93999, "o", "a"]
[2.036155, "o", "s"]
[2.132115, "o", "h"]
[2.239966, "o", " "]
[2.612579, "o", "S"]
[2.888232, "o", "e"]
[3.061429, "o", "cureWilly_UI.sh "]
[3.692239, "o", "\r\n"]
[3.720718, "o", "SecureWily\r\nCopyright (c) 2019 Fani Dimou <fani.dimou92@gmail.com>\r\n\r\nGive the number of services that need a profile for your project:\r\n"]
[3.720791, "o", "A service is defined by a docker image, either it is built by Dockerfile or uses an existing image, with or without docker-compose file.\r\n"]
[6.848055, "o", "1"]
[7.304127, "o", "\r\n"]
[7.304459, "o", "\r\n"]
[7.304606, "o", "Give the name of each service following the next rules:"]
[7.304743, "o", "\r\n"]
[7.304885, "o", "1. The names should not be used for other purposes like named volumes, network etc"]
[7.305025, "o", "\r\n"]
[7.305193, "o", "2. If you use a docker-compose.yml, make sure that you give the same names of services you used inside the yml file and with the same order as they are in it."]
[7.305316, "o", "\r\n"]
[7.305465, "o", "3. If you do not use docker-compose.yml, the names of services should be identical to the names of the corresponding images."]
[7.305596, "o", "\r\n"]
[7.305743, "o", "   Do not worry about special characters, just give the exact same name of the image and let SecureWilly worry about it."]
[7.30586, "o", "\r\n"]
[7.306029, "o", "4. Give one name per line."]
[7.306174, "o", "\r\n"]
[8.024052, "o", "t"]
[8.131877, "o", "e"]
[8.323944, "o", "s"]
[8.455857, "o", "t"]
[8.696003, "o", "1"]
[8.840639, "o", "2"]
[9.031872, "o", "3"]
[9.343991, "o", "\r\n"]
[9.351355, "o", "Is there a Dockerfile to provide for image test123?\r\nIf yes, give the full path to Dockerfile (<path_to_dockerfile>/Dockerfile), if no, type N:\r\n"]
[11.252081, "o", "/"]
[11.720015, "o", "h"]
[11.91202, "o", "o"]
[12.11599, "o", "m"]
[12.211755, "o", "e"]
[12.668076, "o", "/"]
[12.931983, "o", "u"]
[13.11195, "o", "b"]
[13.280208, "o", "u"]
[13.448099, "o", "n"]
[13.543801, "o", "t"]
[13.652005, "o", "u"]
[14.024004, "o", "/"]
[14.517049, "o", "D"]
[14.889016, "o", "o"]
[15.043822, "o", "c"]
[15.152017, "o", "k"]
[15.57196, "o", "r"]
[16.01599, "o", "\b \b"]
[16.148827, "o", "e"]
[16.256007, "o", "r"]
[16.508945, "o", "f"]
[16.664046, "o", "i"]
[16.868955, "o", "l"]
[16.963965, "o", "e"]
[18.717268, "o", "\r\n"]
[18.722128, "o", "\r\nIs there a docker-compose.yml to provide?\r\n"]
[18.722198, "o", "Tip: If you intend to use docker exec later, make sure you include container_name inside the yml file for each service.\r\nIf yes, give the full path to docker-compose.yml (<path_to_yml>/docker-compose.yml), if no, type N:\r\n"]
[21.045374, "o", "N"]
[22.557046, "o", "\r\n"]
[22.558789, "o", "\r\n"]
[22.589633, "o", "\r\nDo you need to create a docker network for your images?\r\nIf yes, specify network's name, if no, type N:\r\n"]
[23.301043, "o", "N"]
[24.417179, "o", "\r\n"]
[24.425762, "o", "\r\nIn the next lines please give a testplan that you want to execute inside the container.\r\nMake sure you follow the next rules:\r\n1. Give a command per line\r\n"]
[24.425817, "o", "2. Include the docker run commands or docker-compose commands with which you will start and stop your container(s).\r\n"]
[24.426118, "o", "3. If no docker-compose is used, it is wise to use the --name flag to run your containers. If you do not do that, SecureWilly will name your containers after the corresponding service name.\r\n4. If your image is getting built by Dockerfile, make sure to give the same name to the image as the service you gave before, using docker build <path_to_Dockerfile> -t <service>\r\n5. Do NOT use flag --security-opt to run your containers.\r\n6. If you docker run servers os daemons in general, make sure you add flag -d\r\n7. Type Done when you're finished.\r\nRemember, you are the one who knows how your program works. The commands will be executed in a script, so take all the actions needed to make it work.\r\n"]
[26.348998, "o", "d"]
[26.492979, "o", "o"]
[26.817108, "o", "c"]
[27.225027, "o", "k"]
[27.368845, "o", "e"]
[27.513024, "o", "r"]
[27.585109, "o", " "]
[27.765092, "o", "b"]
[27.981142, "o", "u"]
[28.197046, "o", "i"]
[28.46099, "o", "l"]
[28.604925, "o", "d"]
[28.725078, "o", " "]
[29.985122, "o", "/"]
[30.273072, "o", "h"]
[30.693068, "o", "o"]
[30.885067, "o", "m"]
[30.957749, "o", "e"]
[31.113017, "o", "."]
[31.917313, "o", "\b \b"]
[32.168993, "o", "/"]
[32.54105, "o", "u"]
[32.745077, "o", "b"]
[32.925155, "o", "u"]
[33.081176, "o", "n"]
[33.188854, "o", "t"]
[33.273024, "o", "u"]
[33.717229, "o", "/"]
[34.557028, "o", "D"]
[34.941062, "o", "o"]
[35.073066, "o", "c"]
[35.169828, "o", "k"]
[35.27691, "o", "e"]
[35.457094, "o", "r"]
[35.661052, "o", "f"]
[35.793055, "o", "i"]
[35.985166, "o", "l"]
[36.045026, "o", "e"]
[36.141805, "o", " "]
[36.86129, "o", "-"]
[36.992954, "o", "-"]
[37.209043, "o", "t"]
[37.316839, "o", "a"]
[37.413165, "o", "g"]
[37.580904, "o", " "]
[38.949016, "o", "t"]
[39.046778, "o", "e"]
[39.213006, "o", "s"]
[39.296945, "o", "t"]
[39.59712, "o", "1"]
[39.753151, "o", "2"]
[39.92141, "o", "3"]
[41.769077, "o", "\r\n"]
[42.921454, "o", "D"]
[43.24517, "o", "o"]
[43.496925, "o", "n"]
[43.616935, "o", "e"]
[44.036992, "o", "\r\n"]
[44.037277, "o", "\r\nThe script that will be used as a test plan for your project is given below:\r\n\r\n"]
[44.037782, "o", "#!/bin/bash\r\n \r\ndocker build /home/ubuntu/Dockerfile --tag test123\r\n"]
[44.037899, "o", "\r\nIs the script corresponding to your test plan? [Y/N]\r\n"]
[45.608958, "o", "Y"]
[47.145013, "o", "\r\n"]
[47.14531, "o", "\r\n"]
[47.188728, "o", "mkdir: cannot create directory ‘../parser_output’: File exists\r\n"]
[47.273133, "o", "mkdir: cannot create directory ‘../parser_output’: File exists\r\n"]
[47.619506, "o", "Setting /etc/apparmor.d/test123_profile to complain mode.\r\n"]
[47.672587, "o", "Deleted archived journal /var/log/journal/a58b60f4b01c46bbb25e950a81e5e1aa/system@ea6af172f2cb4476a30462daca433452-0000000000001257-0005c288389e9680.journal (8.0M).\r\n"]
[47.672859, "o", "Deleted archived journal /var/log/journal/a58b60f4b01c46bbb25e950a81e5e1aa/system@0005c2983386e7b1-f6509bfaf980a95b.journal~ (8.0M).\r\n"]
[47.673274, "o", "Deleted archived journal /var/log/journal/a58b60f4b01c46bbb25e950a81e5e1aa/user-1000@adbeabc9e91748939e72cc3b54a61572-00000000000012d2-0005c28845df5352.journal (8.0M).\r\n"]
[47.673431, "o", "Deleted archived journal /var/log/journal/a58b60f4b01c46bbb25e950a81e5e1aa/system@0005c2ad979dbd75-bcba721a86612105.journal~ (8.0M).\r\n"]
[47.673567, "o", "Deleted archived journal /var/log/journal/a58b60f4b01c46bbb25e950a81e5e1aa/system@0005c2c0c3a6e371-dfb44a5002156b15.journal~ (8.0M).\r\n"]
[47.67409, "o", "Deleted archived journal /var/log/journal/a58b60f4b01c46bbb25e950a81e5e1aa/system@68692de601ff4d9eae5391ee258cef5c-0000000000000001-0005c2c0c3a568bd.journal (8.0M).\r\n"]
[47.674765, "o", "Deleted archived journal /var/log/journal/a58b60f4b01c46bbb25e950a81e5e1aa/system@68692de601ff4d9eae5391ee258cef5c-000000000000276c-0005c2c0c58caac6.journal (8.0M).\r\n"]
[47.67506, "o", "Deleted archived journal /var/log/journal/a58b60f4b01c46bbb25e950a81e5e1aa/user-1000@adbeabc9e91748939e72cc3b54a61572-0000000000002779-0005c2c0c80ac7dc.journal (8.0M).\r\nVacuuming done, freed 64.0M of archived journals from /var/log/journal/a58b60f4b01c46bbb25e950a81e5e1aa.\r\nVacuuming done, freed 0B of archived journals from /run/log/journal.\r\nVacuuming done, freed 0B of archived journals from /var/log/journal.\r\n"]
[47.681277, "o", "tee: /var/log/audit/audit.log"]
[47.681344, "o", ": No such file or directory\r\n"]
[47.713708, "o", "unable to prepare context: context must be a directory: /home/ubuntu/Dockerfile\r\n"]
[47.722038, "o", "cat: /var/log/audit/audit.log"]
[47.722106, "o", ": No such file or directory\r\n"]
[47.763614, "o", "Error: No such container: test123\r\n"]
[47.768475, "o", "Prune volumes\r\n"]
[47.798168, "o", "Total reclaimed space: 0B\r\n"]
[48.28401, "o", "Setting /etc/apparmor.d/test123_profile to enforce mode.\r\n"]
[48.345374, "o", "Vacuuming done, freed 0B of archived journals from /var/log/journal.\r\nVacuuming done, freed 0B of archived journals from /run/log/journal.\r\nVacuuming done, freed 0B of archived journals from /var/log/journal/a58b60f4b01c46bbb25e950a81e5e1aa.\r\n"]
[48.350948, "o", "tee: /var/log/audit/audit.log"]
[48.351236, "o", ": No such file or directory\r\n"]
[48.381837, "o", "unable to prepare context: context must be a directory: /home/ubuntu/Dockerfile\r\n"]
[48.38997, "o", "cat: /var/log/audit/audit.log"]
[48.390204, "o", ": No such file or directory\r\n"]
[48.431948, "o", "Error: No such container: test123\r\n"]
[48.436596, "o", "Prune volumes\r\n"]
[48.466, "o", "Total reclaimed space: 0B\r\n"]
[48.649262, "o", "mkdir: cannot create directory ‘../parser_output/Alerts’: File exists\r\n"]
[48.679935, "o", "rm: cannot remove 'alert_logs_': No such file or directory\r\n"]
[48.68268, "o", "rm: cannot remove '../Parser/next*': No such file or directory\r\n"]
[48.68349, "o", "rm: cannot remove '../Parser/if*'"]
[48.683531, "o", ": No such file or directory\r\n"]
[48.683681, "o", "\r\n----------------------------------------------------------------------------------------------\r\n"]
[48.683771, "o", "Profiles produced for all services are located in parser_output directory, as service_profile.\r\n----------------------------------------------------------------------------------------------\r\nPlease take a look at the Alerts directory, for any logs produced because of vulnerabilities\r\n"]
[48.683851, "o", "SecureWilly does not act on the particular vulnerabilities detected, but it is recommended\r\nyou work your way around them, if possible, in order to avoid the possibility of attacks\r\n----------------------------------------------------------------------------------------------\r\n\r\n"]
[48.684774, "o", "\u001b]0;ubuntu@ubuntu2004: ~/SecureWilly/Parser\u0007\u001b[01;32mubuntu@ubuntu2004\u001b[00m:\u001b[01;34m~/SecureWilly/Parser\u001b[00m$ "]
[51.933406, "o", "c"]
[52.149181, "o", "a"]
[52.425093, "o", "t"]
[52.544974, "o", " "]
[53.061183, "o", "/"]
[53.300979, "o", "e"]
[53.781055, "o", "t"]
[53.925216, "o", "c"]
[54.548909, "o", "/"]
[55.160914, "o", "a"]
[55.449137, "o", "p"]
[55.581061, "o", "p"]
[55.688841, "o", "a"]
[55.929134, "o", "r"]
[56.937061, "o", "m"]
[57.128965, "o", "o"]
[57.236822, "o", "r"]
[57.501034, "o", "."]
[57.776984, "o", "d"]
[58.305063, "o", "/"]
[58.713036, "o", "t"]
[58.820958, "o", "e"]
[58.988986, "o", "s"]
[59.049015, "o", "t"]
[59.457102, "o", "1"]
[60.899646, "o", "23_profile "]
[61.869766, "o", "\r\n"]
[61.870494, "o", "#include <tunables/global>\r\n\r\nprofile test123_profile flags=(attach_disconnected, mediate_deleted) {\r\n\tfile,  #Allows access to containers filesystem\r\n\t/var/lib/docker/* r, #Access to layers of filesystem\r\n\tdeny ptrace (readby, tracedby), #Confront container breakout attacks\r\n}\r\n"]
[61.870676, "o", "\u001b]0;ubuntu@ubuntu2004: ~/SecureWilly/Parser\u0007\u001b[01;32mubuntu@ubuntu2004\u001b[00m:\u001b[01;34m~/SecureWilly/Parser\u001b[00m$ "]
[64.089095, "o", "exit\r\n"]
